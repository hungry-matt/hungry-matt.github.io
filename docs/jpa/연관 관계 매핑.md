---
layout: default
title: 연관 관계 매핑
parent: JPA
---


Table of contents


- TOC
{:toc}


---

# 연관 관계 매핑

테이블의 연관 관계를 나타낼때 RDB에서는 외래키를 사용하고 JPA에서는 객체를 참조하는 방식으로 연관 관계를 매핑할 수 있다.

JPA를 이용하여 객체를 협력 관계로 만들려면 `객체 중심`으로 관계를 매핑하는 테이블을 설계해야 한다.

# 연관 관계의 주인

두 객체의 연관관계중 하나를 정해서 테이블의 외래키를 관리해야 하는데 이 외래키를 관리 하는 객체를 `연관 관계의 주인`이라 한다.

## 양방향 매핑 규칙

양방향 매핑이란 양쪽에서 참조하는 것을 의미한다.

- 두 연관 관계중 연관 관계의 주인을 정해야 함

- 연관 관계의 주인만이 데이터베이스 연관 관계와 매핑되고 외래키를 등록, 수정, 삭제 할 수 있음

- 주인이 아닌 쪽은 읽기만 가능

- mappedBy 속성으로 연관 관계의 주인을 지정할 수 있음

- 연관 관계의 주인은 mappedBy 속성을 사용할 수 없음

```java
@Entity
public class Team {
    @Id
    @Column(name = "TEAM_ID")
    private Long id;

    private String name;

    // 연관 관계의 주인은 Member.team
    // Team 엔티티는 mappedBy를 통해 주인이 아님을 설정
    @OneToMany(mappedBy = "team") 
    private List<Member> members = new ArrayList<>();
}
```

- 항상 '다(N)'쪽이 외래키를 가진다.

- @ManyToOne은 항상 연관관계의 주인이 된다. (mappedBy 속성이 없다.)